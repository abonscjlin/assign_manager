# Docker è‡ªå‹•æ‹‰å–åŠŸèƒ½èªªæ˜

## ğŸ”„ æ¦‚è¿°

å·¥ä½œåˆ†é…ç®¡ç†ç³»çµ±çš„Dockeré…ç½®å·²ç¶“å¢å¼·ï¼Œç¾åœ¨æ”¯æŒæ¯æ¬¡å®¹å™¨å•Ÿå‹•æ™‚è‡ªå‹•æª¢æŸ¥ä¸¦æ‹‰å–æœ€æ–°ä»£ç¢¼ï¼Œç¢ºä¿å§‹çµ‚é‹è¡Œæœ€æ–°ç‰ˆæœ¬ã€‚

## ğŸš€ åŠŸèƒ½ç‰¹é»

### 1. **æ™ºèƒ½ä»£ç¢¼æ›´æ–°**
- âœ… æ¯æ¬¡å®¹å™¨å•Ÿå‹•æ™‚è‡ªå‹•æª¢æŸ¥GitHubå€‰åº«
- âœ… å¦‚æœç™¼ç¾æ›´æ–°ï¼Œè‡ªå‹•æ‹‰å–æœ€æ–°ä»£ç¢¼
- âœ… å¦‚æœæ˜¯é¦–æ¬¡é‹è¡Œï¼Œè‡ªå‹•å…‹éš†æ•´å€‹å€‰åº«
- âœ… æ”¯æŒåˆ†æ”¯åˆ‡æ›å’Œé…ç½®

### 2. **å®‰å…¨çš„æ›´æ–°æ©Ÿåˆ¶**
- ğŸ”’ æœ¬åœ°ä¿®æ”¹æœƒè¢«è‡ªå‹•æš«å­˜ï¼ˆgit stashï¼‰
- ğŸ”’ æ›´æ–°å¤±æ•—æ™‚è‡ªå‹•å›æ»¾
- ğŸ”’ ä¿ç•™å®¹å™¨é…ç½®å’Œæ•¸æ“šä¸è®Š

### 3. **æŒä¹…åŒ–å­˜å„²**
- ğŸ’¾ Gitæ­·å²ä½¿ç”¨Docker VolumeæŒä¹…åŒ–
- ğŸ’¾ çµæœæ–‡ä»¶æ›è¼‰åˆ°å®¿ä¸»æ©Ÿç›®éŒ„
- ğŸ’¾ å®¹å™¨é‡å•Ÿæ™‚ä¿æŒä»£ç¢¼ç‹€æ…‹

## ğŸ› ï¸ ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬æ“ä½œ

```bash
# å•Ÿå‹•æœå‹™ï¼ˆè‡ªå‹•æ‹‰å–æœ€æ–°ä»£ç¢¼ï¼‰
./docker-start.sh start

# å¿«é€Ÿå•Ÿå‹•ï¼ˆä½¿ç”¨ç·©å­˜ï¼‰
./docker-start.sh start-fast

# å¼·åˆ¶æ›´æ–°ä»£ç¢¼ä¸¦é‡å•Ÿ
./docker-start.sh update

# æŸ¥çœ‹æœå‹™ç‹€æ…‹
./docker-start.sh status

# æŸ¥çœ‹æ—¥èªŒ
./docker-start.sh logs
```

### å¼·åˆ¶æ›´æ–°æ“ä½œ

```bash
# å¼·åˆ¶æ›´æ–°ä»£ç¢¼ï¼ˆæœƒé‡æ–°å…‹éš†å€‰åº«ï¼‰
./docker-start.sh update

# å®Œå…¨æ¸…ç†ä¸¦é‡æ–°é–‹å§‹
./docker-start.sh clean
./docker-start.sh start
```

## ğŸ”§ é…ç½®é¸é …

### ç’°å¢ƒè®Šæ•¸é…ç½®

å¯ä»¥é€šéç’°å¢ƒè®Šæ•¸è‡ªå®šç¾©å€‰åº«å’Œåˆ†æ”¯ï¼š

```bash
# ä½¿ç”¨ä¸åŒçš„å€‰åº«
export REPO_URL="https://github.com/your-username/assign_manager.git"
./docker-start.sh start

# ä½¿ç”¨ä¸åŒçš„åˆ†æ”¯
export GIT_BRANCH="development"
./docker-start.sh start

# ä¸€æ¬¡æ€§è¨­ç½®
REPO_URL="https://github.com/your-fork/assign_manager.git" GIT_BRANCH="feature-branch" ./docker-start.sh start
```

### Docker Composeé…ç½®

åœ¨ `docker-compose.yml` ä¸­çš„ç›¸é—œé…ç½®ï¼š

```yaml
environment:
  - REPO_URL=${REPO_URL:-https://github.com/abonscjlin/assign_manager.git}
  - GIT_BRANCH=${GIT_BRANCH:-main}

volumes:
  # æŒä¹…åŒ–Gitæ­·å²
  - assign_manager_code:/app/.git
```

## ğŸ“‹ æ›´æ–°æµç¨‹è©³è§£

### å®¹å™¨å•Ÿå‹•æ™‚çš„è‡ªå‹•æ›´æ–°æµç¨‹ï¼š

1. **æª¢æŸ¥Gitå€‰åº«**
   ```
   ğŸ“‚ æª¢æŸ¥ /app/.git æ˜¯å¦å­˜åœ¨
   ```

2. **å­˜åœ¨å€‰åº«çš„æƒ…æ³**
   ```
   ğŸ”„ git fetch origin
   ğŸ“Š æ¯”è¼ƒæœ¬åœ°å’Œé ç¨‹æäº¤
   ğŸ†• ç™¼ç¾æ›´æ–°æ™‚è‡ªå‹•æ‹‰å–
   âœ… é¡¯ç¤ºç•¶å‰æäº¤ä¿¡æ¯
   ```

3. **é¦–æ¬¡é‹è¡Œçš„æƒ…æ³**
   ```
   ğŸ“¥ git clone å®Œæ•´å€‰åº«
   ğŸ“ è¨­ç½®å·¥ä½œç›®éŒ„
   âœ… é¡¯ç¤ºåˆå§‹æäº¤ä¿¡æ¯
   ```

4. **ä¾è³´å®‰è£**
   ```
   ğŸ“‹ æª¢æŸ¥ requirements.txt
   ğŸ“¦ è‡ªå‹•å®‰è£Pythonä¾è³´
   âœ… æº–å‚™é‹è¡Œç’°å¢ƒ
   ```

5. **æœå‹™å•Ÿå‹•**
   ```
   ğŸŒ å•Ÿå‹•APIæœå‹™å™¨
   ğŸ¥ å¥åº·æª¢æŸ¥å°±ç·’
   ğŸ“¡ æœå‹™å¯ç”¨æ–¼å¤–éƒ¨èª¿ç”¨
   ```

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œå’Œè§£æ±ºæ–¹æ¡ˆ

#### 1. **ä»£ç¢¼æ›´æ–°å¤±æ•—**
```bash
# æŸ¥çœ‹è©³ç´°æ—¥èªŒ
./docker-start.sh logs

# å¼·åˆ¶é‡æ–°å…‹éš†
./docker-start.sh update
```

#### 2. **æ¬Šé™å•é¡Œ**
```bash
# ä¿®å¾©Dockeræ¬Šé™
./docker-start.sh fix-perm

# æˆ–æ‰‹å‹•æ·»åŠ åˆ°dockerçµ„
sudo usermod -aG docker $USER
newgrp docker
```

#### 3. **å®¹å™¨ç„¡æ³•å•Ÿå‹•**
```bash
# æª¢æŸ¥æœå‹™ç‹€æ…‹
./docker-start.sh status

# é‡å»ºå®¹å™¨
./docker-start.sh rebuild

# å®Œå…¨æ¸…ç†é‡æ–°é–‹å§‹
./docker-start.sh clean
./docker-start.sh start
```

#### 4. **ç¶²çµ¡é€£æ¥å•é¡Œ**
```bash
# æª¢æŸ¥ç¶²çµ¡é€£æ¥
curl -I https://github.com

# ä½¿ç”¨æ›¿ä»£å€‰åº«åœ°å€
export REPO_URL="https://ghproxy.com/https://github.com/abonscjlin/assign_manager.git"
./docker-start.sh start
```

## ğŸ“Š ç›£æ§å’Œæ—¥èªŒ

### æŸ¥çœ‹æ›´æ–°æ—¥èªŒ
```bash
# å¯¦æ™‚æŸ¥çœ‹å®¹å™¨æ—¥èªŒ
./docker-start.sh logs

# æŸ¥çœ‹æœ€è¿‘çš„æ—¥èªŒ
docker logs assign-manager-api --tail 50

# æŸ¥çœ‹ç‰¹å®šæ™‚é–“çš„æ—¥èªŒ
docker logs assign-manager-api --since "1h"
```

### æª¢æŸ¥ä»£ç¢¼ç‰ˆæœ¬
```bash
# é€²å…¥å®¹å™¨æª¢æŸ¥
docker exec -it assign-manager-api bash
cd /app
git log --oneline -5
```

## ğŸ” å®‰å…¨æ³¨æ„äº‹é …

1. **æ•æ„Ÿä¿¡æ¯**ï¼šç’°å¢ƒè®Šæ•¸å’Œé…ç½®æ–‡ä»¶ä¸æœƒè¢«Gitè¿½è¹¤
2. **ç¶²çµ¡å®‰å…¨**ï¼šåƒ…é€šéHTTPSå…‹éš†å…¬é–‹å€‰åº«
3. **æ•¸æ“šéš”é›¢**ï¼šå®¹å™¨æ•¸æ“šèˆ‡å®¿ä¸»æ©Ÿé©ç•¶éš”é›¢
4. **æ¬Šé™æ§åˆ¶**ï¼šä½¿ç”¨æœ€å°æ¬Šé™åŸå‰‡

## ğŸ“ˆ æ€§èƒ½å„ªåŒ–

### 1. **ç·©å­˜ç­–ç•¥**
- ä½¿ç”¨Docker Volumeç·©å­˜Gitæ­·å²
- Pythonä¾è³´ç·©å­˜åœ¨æ˜ åƒå±¤ä¸­
- æ”¯æŒå¿«é€Ÿå•Ÿå‹•æ¨¡å¼

### 2. **ç¶²çµ¡å„ªåŒ–**
- åƒ…åœ¨æª¢æ¸¬åˆ°æ›´æ–°æ™‚æ‰æ‹‰å–ä»£ç¢¼
- æ”¯æŒå¢é‡æ›´æ–°
- å¯é…ç½®ä»£ç†æˆ–é¡åƒæº

### 3. **è³‡æºç®¡ç†**
- å®¹å™¨è‡ªå‹•é‡å•Ÿç­–ç•¥
- æ—¥èªŒå¤§å°é™åˆ¶
- å¥åº·æª¢æŸ¥æ©Ÿåˆ¶

## ğŸ¯ æœ€ä½³å¯¦è¸

1. **å®šæœŸæ›´æ–°**ï¼šå»ºè­°å®šæœŸé‡å•Ÿå®¹å™¨ä»¥ç²å–æœ€æ–°ä»£ç¢¼
2. **ç›£æ§æ—¥èªŒ**ï¼šé—œæ³¨æ›´æ–°éç¨‹çš„æ—¥èªŒè¼¸å‡º
3. **å‚™ä»½é…ç½®**ï¼šä¿ç•™é‡è¦çš„é…ç½®æ–‡ä»¶å‚™ä»½
4. **æ¸¬è©¦ç’°å¢ƒ**ï¼šåœ¨ç”Ÿç”¢ç’°å¢ƒå‰å…ˆåœ¨æ¸¬è©¦ç’°å¢ƒé©—è­‰æ›´æ–°

## ğŸ”— ç›¸é—œæ–‡ä»¶

- `Dockerfile` - å®¹å™¨æ§‹å»ºé…ç½®
- `docker-compose.yml` - æœå‹™ç·¨æ’é…ç½®  
- `docker-entrypoint.sh` - å®¹å™¨å•Ÿå‹•è…³æœ¬
- `docker-start.sh` - ç®¡ç†è…³æœ¬
- `Dockeréƒ¨ç½²èªªæ˜.md` - éƒ¨ç½²æŒ‡å— 